
<!-- README.md is generated from README.Rmd. Please edit that file -->

# Simulation-based sample size calculations for recurrent events with competing deaths

## Download from Github

``` r
require(devtools)
#> Indlæser krævet pakke: devtools
#> Indlæser krævet pakke: usethis
devtools::install_github("JulieKFurberg/simpowerrecurrent", force = TRUE)
#> Downloading GitHub repo JulieKFurberg/simpowerrecurrent@HEAD
#> * checking for file 'C:\Users\jukf\AppData\Local\Temp\Rtmp2nbI4Y\remotes7d06cf37e3c\JulieKFurberg-simpowerrecurrent-8ca3921/DESCRIPTION' ... OK
#> * preparing 'simpowerrecurrent':
#> * checking DESCRIPTION meta-information ... OK
#> * checking for LF line-endings in source and make files and shell scripts
#> * checking for empty or unneeded directories
#> * building 'simpowerrecurrent_0.0.0.9000.tar.gz'
#> 
require(simpowerrecurrent)
#> Indlæser krævet pakke: simpowerrecurrent

# A couple extra packages
require(ggplot2)
#> Indlæser krævet pakke: ggplot2
require(survival)
#> Indlæser krævet pakke: survival
require(mets)
#> Indlæser krævet pakke: mets
#> Indlæser krævet pakke: timereg
#> Indlæser krævet pakke: lava
#> 
#> Vedhæfter pakke: 'lava'
#> Det følgende objekt er maskeret fra 'package:ggplot2':
#> 
#>     vars
#> mets version 1.3.0
```

## Simulation of a single data set

``` r
mu0 <- function(time, a){a  * time^2}
S0 <- function(time, b){b * time}


times <- seq(0, 100, by = 25)

cumhaz_mu <- data.frame(time = times,
                        cumhaz = mu0(time = times, a = 0.1))

cumhaz_S <- data.frame(time = times,
                       cumhaz = S0(time = times, b = 0.01))
# Visual
ggplot(aes(x = time, y = cumhaz), data = cumhaz_mu) +
  geom_line() + ggtitle("Mu_0(t) for recurrent events") +
  geom_point()
```

<img src="man/figures/README-example-1.png" width="100%" />

``` r
ggplot(aes(x = time, y = cumhaz), data = cumhaz_S) +
  geom_line() + ggtitle("Lambda_0^D(t) for death") + geom_point()
```

<img src="man/figures/README-example-2.png" width="100%" />

``` r
# Simulating a single data set
sim1 <- simrecurprop(n = 100, 
                     beta = 0,
                     gamma = 0,
                     mu0 = cumhaz_mu,
                     Lam0D = cumhaz_S,
                     crate = 0.01,
                     accrualtime = 0,
                     admincens = 8000)

head(sim1)
#>   id     start      stop status Z
#> 1  1 0.0000000 0.1660600      1 0
#> 2  1 0.1660600 0.4868173      1 0
#> 3  1 0.4868173 1.1801843      1 0
#> 4  1 1.1801843 1.2707257      1 0
#> 5  1 1.2707257 1.5166039      1 0
#> 6  1 1.5166039 2.0855841      1 0

# Overview of the data set
with(sim1, table(Z, status))
#>    status
#> Z      0    1    2
#>   0   12 3207   19
#>   1    8 3371   15
```

## Esitimation of power for previous example

``` r
simres1 <- powerest(nsims = 100, n = 100, mu0 = cumhaz_mu, Lam0D = cumhaz_S, alpha = 0.05)

simres1
#> $resmat
#>                beta     sebeta reject?         pval
#>   [1,]  0.036279149 0.07493360       0 0.6282789602
#>   [2,] -0.102731729 0.09544976       0 0.2817970837
#>   [3,] -0.089345177 0.08979099       0 0.3197192356
#>   [4,] -0.034932311 0.07707577       0 0.6503900573
#>   [5,] -0.043746531 0.07183461       0 0.5425313509
#>   [6,]  0.036769837 0.08257964       0 0.6561281199
#>   [7,]  0.168983967 0.08405739       1 0.0443951828
#>   [8,] -0.140635858 0.07580630       0 0.0635676672
#>   [9,]  0.077845230 0.07394291       0 0.2924442164
#>  [10,]  0.019789831 0.07250609       0 0.7848991225
#>  [11,]  0.043629373 0.06944979       0 0.5298633552
#>  [12,] -0.055008556 0.07958407       0 0.4894394926
#>  [13,]  0.171348292 0.10362684       0 0.0982265651
#>  [14,] -0.095710817 0.07556485       0 0.2052965823
#>  [15,]  0.107088654 0.07869600       0 0.1735803430
#>  [16,]  0.067481653 0.06982437       0 0.3338198564
#>  [17,] -0.001421984 0.07975834       0 0.9857755463
#>  [18,] -0.084004824 0.09104952       0 0.3562011703
#>  [19,]  0.020886682 0.08550337       0 0.8070147036
#>  [20,]  0.011124513 0.08016407       0 0.8896304800
#>  [21,] -0.094272569 0.09090571       0 0.2997187148
#>  [22,]  0.121207691 0.08131463       0 0.1360662160
#>  [23,] -0.054737725 0.08142002       0 0.5014001831
#>  [24,] -0.015520897 0.08553238       0 0.8560047816
#>  [25,]  0.156950584 0.09275744       0 0.0906356913
#>  [26,]  0.061597848 0.09305428       0 0.5079993496
#>  [27,] -0.071507184 0.08385081       0 0.3937754450
#>  [28,] -0.032677307 0.08478437       0 0.6999287604
#>  [29,] -0.073096158 0.08730337       0 0.4024429851
#>  [30,]  0.162517797 0.07504721       1 0.0303462994
#>  [31,]  0.154785788 0.08047448       0 0.0544280007
#>  [32,] -0.044289424 0.08193443       0 0.5888197574
#>  [33,] -0.085469531 0.08645223       0 0.3228426898
#>  [34,]  0.134867754 0.09710652       0 0.1648741004
#>  [35,]  0.073532728 0.09180793       0 0.4231658597
#>  [36,] -0.075319188 0.07898959       0 0.3403200617
#>  [37,]  0.018517749 0.09070347       0 0.8382308062
#>  [38,]  0.106050945 0.08115962       0 0.1913159816
#>  [39,]  0.079269592 0.09069451       0 0.3821026813
#>  [40,]  0.192259033 0.09895111       0 0.0520197956
#>  [41,]  0.071063497 0.06857067       0 0.3000369683
#>  [42,]  0.042881941 0.10032775       0 0.6690744937
#>  [43,]  0.214591426 0.08153838       1 0.0084937797
#>  [44,]  0.047999965 0.06163692       0 0.4361249468
#>  [45,] -0.058178111 0.07830983       0 0.4575288002
#>  [46,] -0.085307961 0.05563518       0 0.1251906919
#>  [47,] -0.102542538 0.07677662       0 0.1816813693
#>  [48,]  0.026332401 0.07702564       0 0.7324521793
#>  [49,] -0.151109437 0.08401406       0 0.0720786898
#>  [50,]  0.030800861 0.08657966       0 0.7220265163
#>  [51,] -0.129526709 0.07133887       0 0.0694234399
#>  [52,]  0.124239651 0.06775124       0 0.0666893316
#>  [53,] -0.072061029 0.08127970       0 0.3753045556
#>  [54,] -0.023707581 0.06494671       0 0.7150880683
#>  [55,]  0.015455635 0.07693194       0 0.8407766737
#>  [56,]  0.011804309 0.08257158       0 0.8863229549
#>  [57,] -0.156436227 0.07841600       1 0.0460480070
#>  [58,]  0.056370757 0.07072140       0 0.4254034040
#>  [59,] -0.030555659 0.09639423       0 0.7512539196
#>  [60,]  0.023887568 0.08471515       0 0.7779625481
#>  [61,] -0.022045569 0.08723011       0 0.8004777176
#>  [62,]  0.097620574 0.09489089       0 0.3035893864
#>  [63,]  0.278777965 0.07943362       1 0.0004488296
#>  [64,]  0.017649806 0.09457058       0 0.8519499197
#>  [65,] -0.180743747 0.09080815       1 0.0465478621
#>  [66,] -0.041060499 0.09454862       0 0.6640857197
#>  [67,] -0.062893500 0.08861215       0 0.4778519753
#>  [68,] -0.072583700 0.09011962       0 0.4205801876
#>  [69,]  0.132200447 0.08632084       0 0.1256456520
#>  [70,]  0.051642948 0.09003355       0 0.5662407376
#>  [71,]  0.073131639 0.09337149       0 0.4334902754
#>  [72,]  0.027494546 0.06143101       0 0.6544650978
#>  [73,] -0.037138756 0.09156224       0 0.6850276117
#>  [74,]  0.084390173 0.08479038       0 0.3196000621
#>  [75,] -0.062309003 0.08367001       0 0.4564534999
#>  [76,]  0.161083905 0.06311835       1 0.0107077933
#>  [77,] -0.011334395 0.08511243       0 0.8940591961
#>  [78,] -0.049322618 0.08652260       0 0.5686405567
#>  [79,] -0.039073018 0.08942891       0 0.6621714976
#>  [80,]  0.057036489 0.08651577       0 0.5097280443
#>  [81,]  0.061070857 0.08167994       0 0.4546502340
#>  [82,] -0.074723572 0.07795703       0 0.3377993343
#>  [83,] -0.126958667 0.08047754       0 0.1146652579
#>  [84,] -0.019765286 0.07217989       0 0.7842124313
#>  [85,]  0.018929396 0.08600493       0 0.8257958855
#>  [86,] -0.041896442 0.09303860       0 0.6524851335
#>  [87,] -0.021084191 0.08267319       0 0.7986994890
#>  [88,] -0.058450786 0.07360683       0 0.4271403339
#>  [89,] -0.103095503 0.08809906       0 0.2419114529
#>  [90,]  0.216704084 0.07047285       1 0.0021050182
#>  [91,]  0.046799966 0.08471738       0 0.5806574848
#>  [92,]  0.081272898 0.07465733       0 0.2763248450
#>  [93,] -0.012754364 0.08652987       0 0.8828175814
#>  [94,] -0.162834155 0.07919469       1 0.0397705102
#>  [95,] -0.004077857 0.06379781       0 0.9490351607
#>  [96,] -0.030515300 0.07143006       0 0.6692298091
#>  [97,] -0.104405911 0.08800864       0 0.2354981986
#>  [98,] -0.151415116 0.06975491       1 0.0299558767
#>  [99,]  0.040731884 0.07947981       0 0.6083144872
#> [100,]  0.057911181 0.07855079       0 0.4609733184
#> 
#> $power
#> [1] 0.1
#> 
#> $betamean
#> [1] 0.006983265
#> 
#> $betasemean
#> [1] 0.08195326
#> 
#> $na.obs
#> [1] 0
```
